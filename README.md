# Time and Attendance System

###### _version-V1.0.1_

---

## 簡介

**Time and Attendance System** 是一款功能完整、安全可靠的現代化出勤管理解決方案。它基於 React 與 Firebase 技術堆疊構建，旨在提供清晰、高效的工時記錄與資料分析功能。

本系統的核心特色在於其精細的多層級權限管理架構，確保了從訪客到最高管理者等不同角色的使用者，都能在安全的權限控制下有效率地完成各自的任務。不管是日常的簽到簽退、大量使用者資料匯入、視覺化報表等等，本系統都提供了完整且流暢的解決方案。

## 功能與用法

本系統根據使用者身份，提供不同的功能操作。

### 公開功能 (訪客)

- **專案說明頁**: 瀏覽系統的核心功能與目標。
- **榮譽榜**: 查看由管理員發布的當週工時冠軍圖表。
- **登錄入口**: 支援由 Google 提供的單一登入 (SSO) 入口。

### 一般使用者 (需登入)

- **個人儀表板**:
  - 清楚展示個人基本資料 (班級、座號、姓名) 及其在系統中的權限身分。
  - 查看個人完整的歷史打卡紀錄列表，包含每日的簽到、簽退時間，並自動計算扣除額外時數後的實際工時。

### 管理者 (Admin)

- **打卡操作面板**:
  - 透過數字鍵盤輸入「班級座號」即可即時篩選、定位指定使用者。
  - 透過彈出的日曆視窗選擇任意日期，為使用者進行補登或修改歷史打卡時間。
  - 可為特定日期的打卡記錄增加「扣除時數」與「文字備註」（例如：事假、會議外出），確保記錄的完整性與準確性。
- **團隊週報表**: 以動態長條圖視覺化呈現當週所有成員的工時排名，可靈活切換週次，並能一鍵將當週前五名**發布**至首頁榮譽榜。
- **個人深度分析**: 可選擇任意使用者及月份，產生包含資料總覽、每日工時趨勢圖及詳細記錄清單的個人月報表。

### 最高管理者 (SuperAdmin)

- **能使用上述所有功能，並額外包含以下管理面板**
- **使用者資料管理**:
  - 支援 **CSV 批次匯入**使用者，提供匯入前預覽、狀態標示（新增/更新）及錯誤修正（移除單筆）功能，確保資料匯入的準確性。
  - 支援 **手動單筆新增**或**覆蓋更新**使用者資料，並提供確認對話方塊防止誤操作。
- **權限管理系統**:
  - 以清單形式清楚展示所有使用者的權限等級。
  - 可透過下拉式選單，動態指派或移除其他使用者的**管理者**或**最高管理者**身分，亦刪除指定使用者。

## 專案架構

本專案採用現代化的前端技術棧，以 Firebase 作為後端即服務 (BaaS)，實現了一個全端、無伺服器 (Serverless) 的應用架構。

### 技術堆疊

- **前端框架**: **React 18** (使用 Vite 進行建構)
- **程式語言**: **TypeScript**
- **路由管理**: **React Router v6**
- **UI 設計**: **Tailwind CSS v4**
- **圖表視覺化**: **Chart.js** (透過 `react-chartjs-2` 整合)
- **後端服務 (Firebase)**:
- **驗證**: **Firebase Authentication** (整合 Google 登錄)
- **資料庫**: **Cloud Firestore** (NoSQL 資料庫)
- **CSV 解析**: **PapaParse**

### 核心架構特色

- **元件化開發**: 遵循 React 的元件化思想，將 UI 拆分為獨立的、可重複使用的元件。
- **聲明式路由與權限控制**: 使用 React Router v6 的嵌套路由和 Outlet 機制，並結合自訂的 `AuthGuard` 和 `AdminGuard` 元件，實現清晰、宣告式的頁面權限管理。
- **集中式狀態管理 (Context API)**:
  - `useAuthStatus` Hook: 統一管理使用者的登入狀態與多層角色（Visitor, User, Admin, SuperAdmin），作為全應用程式權限判斷的唯一真實來源。
  - `useUsers` Context: 全域緩存並提供使用者列表，避免在多個元件中重複讀取資料庫，優化效能並降低成本。
- **Firestore 安全性規則**: 編寫了精細的安全規則，從伺服器端確保了資料的存取權限，嚴格劃分了不同角色的讀寫能力，是本專案安全性的基石。
- **本機快取策略**: 對於不常變更的全域資料（如使用者清單），採用 `localStorage` 進行本機快取，並提供手動更新機制，大幅提升了管理員後台的載入速度和操作流暢度。

## 更新紀錄

### 0.0

```
1.0.1
介紹文件更新

1.0.0
發布正式版本
```

### 0.0

```
0.4.1
UI 介面優化
修復權限不足時無限制發請求之問題
修復登入按鈕在登入情況下持續顯示之問題

0.4.0
UI 介面優化
新增彈出訊息框
處理 404 邏輯
實現資料修改
新增部分組件

0.3.0
控制台功能實現：個人報表、權限管理
路由架構優化
匯入邏輯優化

0.2.0
架構完整化
部分組件實現：打卡、週報表、匯入使用者資料

0.1.0
初步功能實現
資料庫架構決定

0.0.1
建立專案架構

```
